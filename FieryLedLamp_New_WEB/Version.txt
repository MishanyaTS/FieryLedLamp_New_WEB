Текущая версия : FieryLedLamp v5.0_new_web 128 эффектов

ИСТОРИЯ ВЕРСИЙ:
Версия FieryLedLamp v5.0_new_web 128 эффектов
- Добавлена поддержка модуля DS3231 от @gritaro. На ESP8266 подключается параллельно TM1637, стандартные пины подключения изменены (дисплей (DIO/CLK) перенесён с D0/D5 на D5/D1, а мосфет с D1 на D0).
- Добавлен эффект "Радужные кольца".
- Обновлена библиотека для заливки прошивки по воздуху (скопировать из архива).
- Исправлены ошибки.

Версия FieryLedLamp v4.0_new_web 127 эффектов
- Добавлена ​​поддержка ESP32. Для использования обеих плат (ESP32 или ESP8266) в коде не нужно ничего изменять. Просто в Arduino IDE выберите подходящую плату (для ESP32 – "ESP32 Dev Module").
- Добавлена ​​настройка базовой части топиков в веб-интерфейсе.
- Добавлен вывод полных топиков подписки и публикации в веб-интерфейсе.
- Добавлена ​​возможность публиковать ответ периодически. Если он равен нулю, ответы публикуются как обычно только при событии, которая инициирует публикацию.
- Добавлены несколько команд для более удобного управления. Подробности см. в файлы MqttManager.h
- Исправлены ошибки.

Версия FieryLedLamp v3.9_new_web 127 эффектов
- Добавлены 5 новых эффектов: "Аврора", "Ночной Город", "Радужное Пятно", "Сканер", "Фонтан".

Версия FieryLedLamp v3.8_new_web 122 эффекта
- Добавлены настройки MQTT в веб-интерфейсе. Настраивается IP-адрес или URL брокера (пример: 192.168.1.155 или m4.wqtt.ru), порт, имя и пароль для доступа на сервер брокера.
 После настройки необходимо сохранить изменения и перезагрузить лампу (включение/отключение MQTT клиента происходит без подтверждения).

Версия FieryLedLamp v3.7_new_web 122 эффекта
- Добавлен новый эффект "Серпантин" от @SlingMaster.
- Убрал сохранение пароля от WiFi сети в памяти. Чтобы лампа сразу подключалась к вашей сети, пароль прописывается в файле config.json.
- Расширены возможности управления несколькими лампами. Теперь может синхронизироваться текущая папка озвучивания эффектов (включается чекбоксом на странице настройки управления несколькими лампами).
 И если синхронизация папки включена, можно синхронизировать громкость и включение/выключение озвучивания (второй чекбокс).
- Добавлено автоматическое снижение яркости эффектов в 2, 4 или 8 раза (на 50%, 75% или 87%) в ночное время. Управление на главной веб-странице.
- Существенно переработаны некоторые важные алгоритмы. Особенно алгоритмы управления озвучкой.
- Исправлены ошибки в работе с MP3-плеером и отображением времени на дисплее.

Версия FieryLedLamp v3.6_new_web 121 эффектов
- Добавлено использование статического IP адреса.
- Добавлена ​​возможность показывать бегущий текст через заданный интервал.
- Исправление ошибок.

Версия FieryLedLamp v3.51_new_web 121 эффект
- Добавлены шесть новых эффектов: "Аленький цветочек", "Бамбук", "Блуждающий кубик", "Земля Тикси", "Разноцветные одуванчики", "Цифровая турбулентность" от @SlingMaster.

Версия FieryLedLamp v3.5_new_web 115 эффектов
  - Добавлен режим восстановления настроек по умолчанию по пятнадцатикратному нажатию кнопки (даже если она заблокирована). Этот режим сбрасывает сохраняемые настройки в файле config.json.
  - Добавлена кнопка сброса настроек по умолчанию в web интерфейсе на страницы Начальных настроек. Но нажатие на эту кнопку сбрасывает все настройки, включая настройки озвучивания эффектов, настройки эффектов для цикла, настройки управления несколькими лампами и параметры оборудования (т.е. совсем все настройки).
  - Изменение библиотеки "TM1637Display" для часов с точками после каждого сегмента (мигание точки только в центре).
  - Переделал последовательность отключения лампы (Уменьшил вероятность повреждения файлов, хранящихся при выключении лампы).
  - Поправил определение лампой "день/ночь".
  - Удалил эффект "Бегущая строка". Отныне Бегущая строка выводится поверх эффектов. Включается режим чекбоксом в веб-интерфейсе на странице "Настройки пользователя".
  - Фон текста (пространство между буквами) может быть цветным или черным (чекбокс). Там же настраивается цвет текста и скорость вывода.
  - Изменился эффект "Цвет". Если включена "Бегущая строка" и "Масштаб/Цвет" < 3, то текст будет бежать на черном экране (как раньше).
  - Добавлены пять новых эффектов: "Торнадо", "Капли на воде", "Цветовой питон", "Осьминог" и "Плазменные волны" от @Stepko и @SlingMaster.
  - Исправлена ​​ошибка в взаимодействии нескольких ламп, а также другие мелкие ошибки.

Версия FieryLedLamp v3.4_new_web 111 эффектов
  - Переработаны некоторые эффекты:
    - Снегопад (новый алгоритм),
    - Завиток; (новый алгоритм),
    - Реки Ботсвана,
    - Песочные часы,
    - Спектрум,
    - Новогодняя елка (новый алгоритм),
    - Фейерверк
  - Добавлен эффект Звезды
  - Добавлен новый сервер Blynk
  - Добавлен Редактор файлов в меню web-интерфейса (изменять или загружать файлы можно без перепрошивки файловой системы)

Версия FieryLedLamp v3.3_new_web 110 эффектов 
  - Добавлен эффект Планета Земля от SlingMaster.
  - Обновленная страница загрузки ПО (сначала надо заливать FS, затем саму прошивку. Либо использовать WEB_Updater).
  - Новый голос озвучки времени от Maxx1200.

Версия FieryLedLamp v3.3_new_web 109 эффектов 
  - Обновленный WEB-интерфейс

Версия FieryLedLamp_v3.3_IR 109 эффектов
  - Добавлены эффекты Волшебный Фонарик и Огонь с искрами.
  - С целью повышения сетевой безопасности, пароль к WI-FI роутеру вашей сети перенесен в EEPROM. Там получить к нему доступ из сети гораздо сложнее.
 В веб-интерфейсе пароль отображается только при вводе. В других случаях поле пустое.
 Если нажать кнопку "Сохранить" при пустом поле ввода пароля, уже записанный в EEPROM пароль (если он был записан туда) не изменится.
  - Добавлена ​​настройка времени произнесения часов и минут. А также задержки между командами MP3-плеера. Эти настройки, а так же настройки максимального
 тока, типа и ориентации матрицы вынесены на отдельную веб-страницу "Настройки оборудования", попасть на которую можно со страницы "Начальные установки" (кнопка в самом низу).
 Для оригинального чипа время проговаривания часов и минут в пределах 1800 – 2500 мс и задержка 50 – 100 мс.
 Для не оригинального чипа 2500 – 3500 мс и 100 – 180 мс соответственно. Эти параметры вынесены для настройки, потому что они сильно зависят от скорости работы вашей SD-карты (флэшки) и даже количества файлов на ней.
 Выбор чипа DF-Player (оригинальный или нет) в файле Constants.h по-прежнему актуален. Этот выбор влияет на другие параметры. Не пренебрегайте им.
  - Переработан алгоритм сохранения настроек эффектов. Настройки сохраняются в EEPROM в следующих случаях: а) при выключении матрицы (кнопкой, пультом в приложении или веб)
 если не включен режим "Цикл"; б) включение режима "Цикл"; в) при выключении по таймеру, если не активен режим "Цикл".
 Настройка эффектов возобновляется с EEPROM в случаях: а) при перезагрузке лампы (включение питания); б) при включении матрицы (кнопкой, пультом в приложении или веб);
 в) при выключении режима "Цикл". Сохранение настроек эффектов в файл и чтение их из этого файла по-прежнему работает. Как и восстановление их по умолчанию. (В веб-интерфейсе соответствующие кнопки)
  - Как всегда, исправлено несколько ошибок.

Версия FieryLedLamp_v3.2_IR 107 эффектов
  - Добавлено управление инфракрасным пультом. Возможно использование двух разных пультов одновременно. Коды пультов прописываются в файле IR_Remote.h
  Работает автоповтор при удерживании кнопки для тех команд, где это уместно. На дисплее отображается номер эффекта, при переключении эффектов,
  или значение яркости, скорости, масштаба, громкости, при их смене пультом.
  - реструктуризированная EEPROM.
  - Возможно использование библиотеки ArduinoJson как 5-й, так и 6-й версий. В файле Constants.h необходимо закомментировать и разкомментировать соответствующий блок функций.
  По умолчанию используется 6 версия.
  – Как всегда, исправлено несколько ошибок.

 Версия FieryLedLamp_v3.00 107 эффектов
  - Добавлены четыре эффекта: Мозайка, Фейерверк, Контакты, Радиальная волна.
  - Возможность изменять тип и варианты подключения матрицы на той же странице веб-интерфейса. Полезно для нестандартных матриц или когда неизвестно, как она возвращена.
  Подбираете на ходу. (так же можно прикольно разнообразить эффекты. Например: отразить бегущую строку).
  – Там же можно изменять максимальный ток матрицы (максимальную яркость).
  - Добавлена ​​возможность включать/выключать речь времени будильником.
  - Добавлено управление автоматическим таймером отключения лампы. Можно его установить на время от 30 минут до 8 часов с шагом 30 минут, или не выключать.
  - Исправлено несколько мелких (и не очень:) ошибок.

Версия FieryLedLamp_v2.95_RUS 103 эффекта.
  - Добавлена ​​возможность выбора любой папки для будильника (в настройках будильника "Рассвет").
  - Добавлена ​​возможность подключить к DFPlayer флешку. Если подключена и флешка и SD-карта, то будет играть флешка.
  Требования к именам файлов и папок на флешке такие же, как и для CD-карты.
  - Подтверждена работа DFplayer на чипе MH2024K-24SS. Но для корректной работы нужно в файле constant.h закомментировать строчку #define DF_PLAYER_IS_ORIGINAL.
  Уж слишком этот чип тормозился. Теперь точно работают чипы плеера AS20HGN402 (оригинальный DFPlayer-DFRobot), GB3200B и MH2024K-24SS.
  Самый классный звук у оригинального. Самый плохой в 24SS.

  Версия FieryLedLamp_v2.9_RUS 103 зффекта.
  - Если номер привязанной папки от 20 до 90, то проигрывается папка, выбранная случайным образом из диапазона: выбранная папка – (выбранная папка +10).
  То есть, если к эффекту привязали папку 30, то при каждом выборе этого эффекта проигрываемая папка будет выбираться из диапазона 30 - 39 включительно случайным образом.
  Если папка с выбранным номером не существует на SD карте, то будет тишина или будет проигрываться папка с номером 01 (зависит от чипа плеера).
  - Добавлено управление эквалайзером и ручной выбор проигрываемой папки из веб интерфейса
  - Добавлена ​​индикация номера эффекта и папки на дисплее ТМ1637. Индикация в течение 3х секунд при изменении эффекта или папки (что изменилось и показывается)
  - Исправлена ​​ошибка вывода бегущей строкой букв Ёё и украинских Ее, Ее, Іі . Исправлены другие мелкие ошибки. Улучшена стабильность.

  Версия FieryLedLamp_v2.8_RUS 103 эффекта.
   - Список эффектов форматирован по алфавиту. Теперь легко найти нужный эффект в списке при выборе.
   - Добавлена возможность привязки папки озвучивания эффекта к самому эффекту в веб-интерфейсе.

  Версия FieryLedLamp_v2.7_web_v2.5 103 эффекта 
  - Добавлены три эффекта "Мечта дизайнера", "Фейерверк" и "Цветные кудри" от SlingMaster. "Мечту" слегка подправил. Два других практически без изменений, только адаптация.
  - Исправлена ошибка плавного включения матрицы при использовании MOSFET. Вкл/Выкл сделал более плавными.
  - Исправлены другие мелкие ошибки и, вероятно, добавлены новые. :)

  Версия FieryLedLamp_v2.6_web_v2.5 100 эффектов
  - Точно работают чипы плеера AS20HGN402 (оригинальный DFPlayer-DFRobot) и GB3200B. Другие не проверял(не было), но, предполагаю, будут работать.
  - Будильник плавно увеличивает громкость от 0 до установленной. При наступлении установленного времени начинает проговаривать время каждую минуту, если включена озвучка времени 
  для этой поры суток ( день / ноч ). 
  - Папка будильника переехала с 11го номера на 99й. Наполнение папок с 1й по 99ю любое, в соответствии с треьованиями для DFPlayer. ( В GOOGLE полно инфы по этому поводу. Читайте)
  - Провод D8_ESP8266 - TX_DFPlayer переехал с D8  на D6. Связано с особенностью работы ESP8266. При подключении к D8 ESP не всегда стартует.
  - Исправлена ошибка , приводившая к мерцанию эффектов на малой яркости.
  - Если звук не нужен - закоментируйте строки #define MP3_RX_PIN (13U) и #define MP3_TX_PIN (12U) в файле constant.h и для заливки файловой системы
  используйте папку data_no_sound (Перед заливкой просто скопируйте с заменой всё содержимое этой папки в папку data).

  Версия FieryLedLamp_v2.5_web_v2.5 100 эффектов
  - Добавлен эффект "Строб.Хаос.Дифузия" от SlingMaster. Теперь общее количество эффектов 100.
  - Добавленн звук! Теперь есть звуковое сопровождение эффектов, озвучивание времени, к рассвету добавилось звуковое сопровождение. В каждом режиме громкость регулируется отдельно. 
  в веб интерфейсе. Для озвучивания времени используется разделение день/ночь. Так же, отдельно можно включить/выключить каждый режим. Громкость и вкл/выкл звучивания эффектов 
  регулируется "качелькой" телефона и кнопкой на диспле из приложения Котейки. В архиве есть папка SD_actual. Обязательными в ней являются папки 099 и ADVERT. В первую можно 
  добавлять свои файлы и использовать её для озвучивания эффектов. Но нельзя её удалять и удалять файл 000. В папке ADVERT содержатся файлы для озвучивания времени. В папке 011 
  файлы для озвучивания будильника. Наполнение этой и других папок может быть любым. На ваш вкус. Имена файлов должны начинаться с числа, соответствующего номеру файла в папке 
  (от 001 до 255). Номера папок для озвучивания эффектов задаются при проштвке лампы в файле effectTicker.ino . Если задан номер папки 0, то этот эффект озвучиваться не будет. При 
  озвучивании эффекта и будильника папка зацикливается.  Если звук не нужен - закоментируйте строки #define MP3_RX_PIN (13U) и #define MP3_TX_PIN (12U) в файле constant.h и для заливки файловой системы используйте папку 
  data_no_sound (Перед заливкой просто скопируйте с заменой всё содержимое этой папки в папку data). Точно работаeт чип плеера AS20HGN402 (оригинальный DFPlayer-DFRobot)
  - Добавлено восьмикратное нажатие на кнопку для вкл/выкл озвучивания эффектов.
  - Изменён алгоритм однократного и двухкратного нажатия на кнопку при озвучивании будильника. Если "рассвет" озвусивается, то первое однократное нажатие на кнопку выключит только зук, 
  но "рассвет" продолжится, а двухкратное нажатие в этом случае выключит и звук и "рассвет". 
  - В архиве заменена библиотека FastLed на последнюю версию. Устраняет мигание первого диода в случае использования ядра версии 3.Х.Х.
  - Исправлены найденные ошибки.

  Версия FieryLedLamp_v2.4_web_v2.2  ( gunner47_v2.4_web_v2.2_99in1 )
  - Добавлены новые эффекты от SlingMaster. Теперь общее количество эффектов 99.
  - Добавлена возможность регулировки яркости дисплея ТМ1637. Используется регулировка дневной/ночной яркости вывода времени бегущей строкой в "Настройках пользователя" веб интерфейса.
  Так как дисплей имеет 5 градаций яркости (0-4), то яркость дисплея вычисляется как дневная/ночная яркость делённая на 51. 0 - дисплей выключен. 
  - Добавлена в веб интерфейсе регулировка максимальной яркости будильника "Рассвет".
  - Для разработчиков приложений. Добавлены команды ssid, password, esp_mode=0, esp_mode=1. Если вместо команды GET-ВРЕМЯ использовать GET ВРЕМЯ (вместо тире пробел)
  то лампа будет отвечать NEWCURR с дополнительными данными. Для подробностей смотрим функцию void NEWsendCurrent(char *outputBuffer).  Теперь есть возможность доработать приложение,
  чтобы пользователь мог прямо из приложения задать логин и пароль своей сети, а так же изменить режим лампы. В GVR Lamp это уже реализовано. А так же добавить новые функции (и поправить старые :) ).
  - Для тех, кто активно пользуется настройкой параметров эффектов и сохранением их файл, теперь появилась возможность перенести их в новую версию
  прошивки. Подробности под спойлером на моей страничке описания прошивки.
  https://community.alexgyver.ru/threads/wifi-lampa-budilnik-obsuzhdenie-proshivki-ot-gunner47.2418/page-205#post-73929 
  - Доведена до ума работа дисплея ТМ1637, чтобы ничего не тормозило, не вылетало и адекватно реагировало на все именения режимов.
  Исправлены другие найденные ошибки и косяки в работе прошивки.
  
  Версия FieryLedLamp_v2.31_web_v2.2  ( gunner47_v2.31_web_v2.2_94in1 )
  - Добавлена функция однократного вывода своего IP адреса лампой при подаче питания или рестарте. По умолчанию применена для ламп без кнопки.
  Но в файле constant.h перед прошивкой можно включить её и для ламп с кнопкой (или выключить для ламп без кнопки).
  - Добавлен вывод времени на дисплей ТМ1637. По умолчанию выключен. Включить и изменить порты для подключения дисплея можно в файле constant.h .  
  - Исправлена ошибка пропадания кнопки "Получение времени из браузера" при включении защиты паролем страницы "Начальные настройки".
  
  Версия FieryLedLamp_v2.3_web_v2.2  ( gunner47_v2.3_web_v2.2_94in1 )
  - Добавлена синхронизация времени одной кнопкой на странице "Начальные установки" в веб интерфейсе с веб браузером на управляющем устройстве (например, телефоне).
  - Добавлен альтернативный дизайн главной страницы веб интерфейса (по просьбам пользователей). Переключение чекбоксом в самом низу главной страницы.
  - Исправлена ошибка , приводившая к полному нарушению работоспособности физической кнопки.
  - Исправлена работа кнопки запуска таймера включения/выключения лампы. 
  - Автором исправлены ошибки в эффектах "Свеча" и "Украина". В эффект "Украина" добавлена регулировка масштабом времени рестарта.
  - В архив прошивки добавлена краткая инструкция пользователя.  
  
  Версия FieryLedLamp_v2.2_web_v2.1  ( gunner47_v2.2_web_v2.1_94in1 )
  - Добавлены новые эффекты от Сотнега и SlingMastera.
  - Добавлены кнопки сохранения настроек эффектов в файл и чтения их из файла. Фойл сохраняется в ФС лампы. Так что, если долго настраивали
    любимые еффекты, сохраните эти настройки, и всегда сможете к ним вернуться.
  - Добавлено синхронное управление несколькими (до 4) лампами. В отличии от управления через приложение, сдесь не нужно выбирать главную лампу.
    Если во сех лампах прописаны (через web интерфейс) IP адреса соседних ламп, то вы можете управлять любой из ламп приложением, кнопкой или
    через web интерфейс. Все ваши действия будут синхронно отображаться на соседних лампах. Если включить режим Цикл на одной из ламп, то все 
    лампы будут синхронно переключаться вместе с лампой, на которой выбран режим Цикл. Можно, кстати, его включить и на нескольких лампах,
    например с разным временем переключения или с перемешиванием эффектов. Разумеется, желательно (но не обязательно), чтобы набор и
    последовательность эффектов в лампах были одинаковыми (для синхронности).  Пробуйте.

  Версия FieryLedLamp_v2.15_web_v2.0  ( gunner47_v2.15_web_v2.0_88in1 )
  - Добавлено полноценное управление режимом "Цикл".
  - Добавлена регулировка общей яркости эффектов на странице выбора эффектов для цикла.
  - Добавлен чекбокс перемешивать выбранные эффекты в Цикле или воспроизводить по порядку.
  - Добавлены кнопки "Настройки текущего эффекта" "По умолчанию" и "Случайные" Влияет только на эффект , воспроизводящийся в ткущий момент. 
    ( В Настройках пользователя есть чекбокс "Случайный выбор настроек эффектов". Он влияет на все эффекты, Как и кнопка под ним "Cброс настроек эффектов в исходные").
  - Добавлен эффект"Свеча". На плоской матрице смотрится хорошо, На круглой  - только с фасада.
  - Слегка оптимизирован дизайн web страниц интерфейса.

  Версия FieryLedLamp_v2.14_web_v1.7  ( gunner47_v2.14_web_v1.7_87in1 )
  - Добавлен таймер отключения по кнопке лампы. По 4-х кратному (один раз) нажатию таймер устанавливается на 5 минут. По 4-х кратному нажатию с удержанием таймер устанавливается на 10 минут. 
    Если лампа была выключена, она включится. ( 4-х кратное нажатие два раза с интервалом не более 7 секунд, по прежнему осталось АрдуиноОТА обновление.).
  - Добавлена возможность устанавливать время свечения лампы после "Рассвета" от 0 до 99 минут.
  - Исправлены несколько досадных ошибок будильника.
 
  Версия FieryLedLamp_v2.12_web_v1.7  ( gunner47_v2.12_web_v1.7_87in1 )
  - Добавлено полноценное управление будильником "Рассвет".
  - Починен эффект "Бегущая строка" . Можно задавать текст до 42 символов не зависимо от языка ввода..
  - Добавлены кнопки пошаговой (точной :)) настройки значений яркости, скорости и масштаба / цвета.
  - Решены проблемы с регулляторами при переходе между эффектами.

  Версия FieryLedLamp_v2.12_web_v1.6  ( gunner47_v2.12_web_v1.6_87in1 )
  - Добавлено три новых эффекта Пламя, Огонь2021 и Вино. Три имевшихся Пикассо объёденены в один.
  - Добавлена Тёмная тема для web интерфейсаи возможность переключения между темами. По умолчанию - тёмная тема.
  - Добавлена возможность страницу "Начальные Установки" защитить паролем от детей и посторонних любопытных глаз (там пароль Вашей WiFi сети и другое).  Используется пароль точки доступа, поэтому его рекомендуется сменить !!!
  - Добавлены полноценное управдение эффектами в web интерфейсе (кроме управления будильником и режимом цикл).
  - Оптимизирована работа будильника "Рассвет". Добавлена защита от переполнения millis().
  - Известные проблемы: при переходе между эффектами для актуализации значений и положения регуляторов нужно обновить страницу в браузере. 
    Будет решено в следующих версиях

  Версия FieryLamp_v2.12_web_v1.5  ( gunner47_v2.12_web_v1.5_86in1 )
  - Добавлена возможность ввода текста для бегущей строки с сохранением его по умолчанию, настройка режимов вывода времени бегущей строкой на выключенной лампе, Вкл/Выкл автоотключения через 5 часов (если, например ,забыли выключитьуходя из дома).
  - Лампа может автоматически возобновлять показ эффектов при подаче питания, если до пропадания питания она была включена. Добавлено включение / выключение этого режима.
  - Добавлена возможность смены  NTP сервера (сервер часов)

  Версия FieryLamp_v2.11_web_v1.3  ( gunner47_v2.11_web_v1.3_86in1 )
  - Добавлена кнопка включения / выключения лампы в web интерфейс.
  - Исправлена работа сенсорной кнопки лампы.

  Версия 2.1_beta_86in1  ( gunner47_v2.1_web_v1.3_86in1 ) 
  - Добавлен web updater. Теперь можно загружать прошивку по ОТА через любой браузер из bin файла. Нет необходимости устанавливать Arduino IDE. Удобно для поддержки конечных польэователей.
  - Добавлен web интерфейс для настройки  лампы. Можно менять имя лампы, имя и пароль точки доступа, имя и пароль WiFi сети, часовой пояс и переход на летнее время, а так же управлять режимами Random, переход Кнопкой-только по выбранным эффектам или по всем, Вкл/Выкл сенсорной кнопки лампы, управление выводом времени бегущей строкой.
  - Теперь лампу можно включить примерно через секунду после подачи питания не дожидаясь подключения к WIFi сети.
  - Исправлены мелкие ошибки.

  Версия 2.86 эффектов в 1
  - Если удерживать кнопку на выключенной лампе, включится сразу режим "Белый свет".
  - Если включился режим "Белый свет" (не важно, каким способом) и при этом данный режим не добавлен в список для автоматического переключения эффектов, тогда он сам не переключится.
  - Можно сделать, чтобы кнопкой переключались только те режимы, которые добавлены в избранное для режима Цикл. Настройка #define BUTTON_CHANGE_FAVORITES_MODES_ONLY
  - Лампа будет пытаться соединиться с роутером целых 60 секунд, а не 7, как раньше было. Это чтобы лампа могла дождаться загрузки роутера, если электричество в доме отключалось. Настройка #define ESP_CONN_TIMEOUT (60U)
  - Лампа будет проверять появление на роутере интернета через каждые 15 секунд, а не раз в 5 минут, как раньше было. Это чтобы время в лампе поскорее синхронизировалось с NTP-сервером. Настройка #define RESOLVE_INTERVAL (15UL * 1000UL)
  - Лампа будет забывать пароль к роутеру, если её переключили в режим работы "без роутера" кнопкой или по истечении 60 секунд ожидания. Это чтобы приложение не теряло связь с лампой в режиме "без роутера". Настройка #define RESET_WIFI_ON_ESP_MODE_CHANGE
  - Прошивку не удастся загрузить, если актуальные библиотеки из архива с прошивкой не положены в папку с библиотеками.
  - Лампа не будет реагировать на "фантомные нажатия" сенсорной кнопки, если вы забыли её подключить перед включением лампы в розетку. Настройка #define BUTTON_LOCK_ON_START
  - Убран в отдельную настройку сигнал лампы "про проблему со временем" во время работы эффектов. По умолчанию мигать двумя светодиодами во время работы эффектов лампа не будет.  
  - В режиме Цикл эффекты теперь запускаются на случайных, но удачных настройках. Можно это отключить, если не требуется.
  - Добавлены эффекты Цветные драже, Плазменная лампа, Северное сияние, Шары, Магма.
  - Удалён эффект Блуждающий кубик (версию прошивки повышаем, теперь больше нет оправданий, что этот эффект должен быть вместе со всеми 26ю изначальными).
  - Собраны воедино надоевшие эффекты Радуга вертикальная+горизонтальная+диагональная, Звездопад+Метель.
  - Убран запрет на установку времени ожидания подключения к роутеру более 7 секунл (для этого нужно брать библиотеки из архива с прошивкой).
  - В эффекте Белый свет добавлен вертикальный вариант ("направленный свет") для бегунка Масштаб от 50 и выше.
  - Исправлен режим Часы для узких матриц от 11 до 14 пикселей в высоту (не работал).
  - Появилась поддержка команд "RND_" от приложения для управления режимом случайных настроек и возврату к настройкам по умолчанию (а приложение такое пока ещё не появилось).
  
  Версия 1.5.85 эффектов в 1
  - Добавлены эффекты Фея, Источник.
  - Удалён эффект Мячики со шлейфом (это была просто копия Мячиков для демонстрации на других настройках бегунка Скорость).
  - Добавлена возможность автоматической синхронизации времени лампы со смартфоном. Приложение должно поддерживать данную функцию.
  - Добавлена индикация о том, что лампа не знает время (если по низу лампы по кругу бегут 2 цветные точки, значит, не знает).
  - Исправлен баг в библиотеке FastLed в реализации функции blur2d. Рекомендуется положить библиотеки из архива с прошивкой в папку библиотек программы Arduino IDE.
  - Убран запрет поиска ip-адреса лампы, когда лампа работает в виде точки доступа без роутера (в режиме ESP_MODE = 0).
  - Добавлена возможность передать приложению имя лампы (на случай, когда у вас в домашней сети несколько ламп). Приложение должно поддерживать данную функцию.
  
  Версия 1.5.84 эффекта в 1
  - Добавлены эффекты Кипение, Притяжение, Капли на стекле, Дымовые шашки, Тихий океан, Nexus.
  - Убраны эффекты Белый огонь, Цветной огонь, Бeлый вoдoпaд, Быстрый пульс, Пульсирующая кoмeтa (копии и похожие эффекты уже не интересны даже в режиме Цикл, и так эффектов многовато).
  - Убран запрет обновления прошивки "по воздуху", когда лампа работает в виде точки доступа без роутера (в режиме ESP_MODE = 0).
  - Исправления в эффектах ДНК (добавлено управление бегунком Масштаб), Мячики без границ, Вихри, Разноцветные вихри, Стая, Стая и хищник (сглаживание).

  Версия 1.5.83 эффекта в 1
  - Добавлен эффект Огонь 2020.
  - Возвращён эффект Пульсирующая комета.
  - Устранены проблемы "хищник умер", "время бегущей строкой дёргается".
  - Убрано затухание лампы в момент смены эффектов. Убрана предварительная очистка изображения предыдущего эффекта, где было возможно.
  - Добавлены "секретные команды" для установки Будильника Рассвет и Таймера выключения из приложения Blynk (вдруг кому очень надо).

  Версия 1.5.81 эффект в 1
  - Удалён эффект Белая комета.
  - Временно удалён эффект Пульсирующая комета.
  - Временно? добавлен эффект Осциллятор.
  - Обновлена поддержка приложения Blynk для управления текстом бегущей строки и передачи "секретных команд".
  - Эффекты Дым лучше адаптированы для ламп с плохим рассеивателем.
  - Найдена и убрана причина того, что в режиме Цикл лампа полностью гасла между эффектами.
  
  Версия 1.5.82 эффекта в 1
  - Удалён эффект Салют.
  - Добавлены эффекты Жидкая лампа и эффект Попкорн.
  - Реализована возможность установки времени на лампе без подключения к интернету (через приложение для Андроид от @Koteyka - оно есть в архиве с прошивкой).
  - Добавлена поддержка секретных команд reset=wifi, reset=effects, esp_mode=.. (через приложение для Андроид от @Koteyka - оно есть в архиве с прошивкой).
  
  Версия 1.5.80 эффектов в 1
  - В эффекте Цвет добавлена возможность выбора насыщенности бегунком Скорость.
  - Добавлены эффекты Тени, Мотыльки, Лампа с мотыльками, ДНК, Змейки, Салют.
  - Добавлена поддержка приложения Blynk (для iOS и Android) для ламп, имеющих постоянный доступ в Интернет. Если включить, будет всё немного подтормаживать.
  
  Версия 1.5.74 эффекта в 1
  - Добавлен эффект Лавовая лампа.
  
  Версия 1.5.73 эффекта в 1
  - Добавлены эффекты Пикассо.
  - Добавлен эффект Прыгуны.
  
  Версия 1.5.69 эффектов в 1 proper
  - В эффекте Белый свет сделано более плавное изменение площади свечения бегунком Масштаб (может, и зря).
  - В эффекте Метаболз наконец-то исправлена проблема перезагрузки лампы при длительной работе.

  Версия 1.5.69 эффектов в 1
  - Добавлены эффекты Дым и Разноцветный дым.

  Версия 1.5.67 эффектов в 1
  - Добавлен отдельный режим Часы. Просто как обычный предпоследний эффект. "Скорость" регулирует местоположение цифр. Чем лучше рассеивание на лампе, тем бесполезнее этот режим.
    Минимальная необходимая для Часов высота матрицы 11 пикселей. И 7 пикселей по ширине должно быть видно на одной стороне лампы, иначе часть циферблата уползёт на бок.
  - Исправлены баги в эффектах Кометы, вызывающие перезагрузку лампы при отличающихся друг от друга высоте и ширине матрицы, и при матрице высотой менее 14 пикселей.

  Версия 1.5.66 эффектов в 1
  - Все сложные настройки в Constants.h убраны вниз, чтобы не отвлекали.
  - Добавлены эффекты Мячики без границ (Прыжки), Кодовый замок и Кубик Рубика. Скрыт эффект Белые мячики (можно выбрать белый цвет обычным).
  - Добавлена возможность установить автоматическое выключение лампы после нескольких часов непрерывной работы (на случай, если кто-то забыл её выключить). 
    В приложении время выключения будет отображаться неверно, пока не исправят в будущих версиях.

  Версия 1.5.64 эффекта в 1
  - Добавлен эффект Мерцание.
  - Эффект Смена цвета теперь работает медленнее. На масштабах >10 переключение цвета будет через выбранное количество секунд (1 секунда для Скорости = 255 / 2 секунды для Скорости = 254 и т.д.)
  - В эффекте Метаболз добавлена возможность выбора палитры бегунком Масштаб
  - Обновлены эффекты Метель и Звездопад на версию от @Palpalych.
  - Добавлена возможность включить "очередь показов" выбранных эффектов для режима Цикл (чтобы не было повторов слишком часто). Это нужно включать в Constants.h.
  - Добавлена возможность выключить функцию "продолжить демонстрацию последнего эффекта после обесточивания лампы". Это нужно делать в Constants.h.
  - Исправлена размерность переменной currentMode. Возможно, теперь максимальное количество эффектов может быть больше 127 штук. Но это не точно.
  
  Версия 1.5.63 эффекта в 1
  - Добавлены эффекты Тучка в банке, Гроза в банке, Осадки, Огонь 2012.
  - Добавлена регулировка оттенка у эффекта Огонь 2018.
  - В Constants.h добавлен параметр для поддержки более свежей версии приложения от @Koteyka.
  - Оптимизированы функции parsing.h
  - Исправлена функция XY(). Это был аналог getPixelNumber(), но почему-то криво написанный.

  Версия 1.5.60 эффектов в 1
  - Добавлен эффект Огонь 2018.
  - Добавлена регулировка Масштаба у эффектов 2 кометы, 3 кометы, Парящий огонь, Верховой огонь.
  - Возможно, исправлена совместимость прошивки с матрицами, где способ подключения светодиодов отличается от "змейки".

  Версия 1.5.59 эффектов в 1
  - Создан массив настроек всех эффектов по умолчанию. Настройки выбраны с небольшой яркостью для работы в режиме ночника (для себя делал). Можете поставить яркость побольше.
  - Добавлен сброс настроек всех эффектов на значения по умолчанию при поступлении запроса от приложения ("загрузить список эффектов из лампы"). Можно отключить это в Constants.h.
  - Добавлены эффекты Вихри пламени и Разноцветные вихри.
  - В эффекте Светлячки со шлейфом теперь можно выбрать им цвета бегунком Масштаб.

  Версия 1.5.57 эффектов в 1
  - Объединено использование многих переменных в разных эффектах для небольшой экономии памяти.
  - Эффект Цвет тоже вынесен наверх в эффекты с принудительной задержкой в 50 мс, чтобы не травмировать контроллер платы.
  - Добавлены эффекты Стая, Стая и хищник, Призмата, Волны.
  - Увеличен размер буфера для приёма настроек Избранного от приложения в лампу. Теперь максимальное количество эффектов где-то в районе 117.
    (но это уже предел для текущей реализации функций FavoritesManager.h. дальше придётся менять там типы переменных).
  
  Версия 1.5.53 эффекта в 1
  - Изменён способ отправки списка эффектов в лампу. Теперь он не ограничен размером буфера, а ограничен хз чем.
  - Список эффектов расширен до 53 штук.
  - Добавлены новые функции, поддерживаемые приложением от @Koteyka (рисование, бегущая строка).
  
  Версия 1.5: 
    этот же список с гиперссылками: https://community.alexgyver.ru/threads/wifi-lampa-budilnik-obsuzhdenie-proshivki-ot-gunner47.2418/post-30883
  - Исправлен баг в условии процедуры вызова эффектов (у двух эффектов регулятор скорость не работал)
  - Инвертирована регулировка Скорости у всех эффектов, где она работала задом наперёд
  - Из всех эффектов убраны обращения к их порядковым номерам. Теперь любой эффект можно устанавливать на любое место (кроме номеров с 7 по 15), а также делать копии эффектов
  - Переработано распределение флеш-памяти EepromManager.h Теперь можно добавлять новые эффекты и делать копии (копии - для демонстрации одного эффекта на разных настройках).
  - В библиотеке FastLED исправлены коэффициенты расчёта потребления тока
  - Эффект Огонь заменён на "Ламповый огонь", при максимальном Масштабе он же будет эффект Белый огонь
  - Эффект Белый огонь заменён на эффект Водопад, при максимальном Масштабе цвет воды будет белым
  - Внесены исправления эффектов Пейнтбол и Радуга диагональная от @Palpalych (выставляйте Пейнтболу Скорость побольше, чтобы выглядело хорошо)
  - К эффекту Цвет добавлен эффект Бассейн (при максимальной Скорости блики воды исчезают, работает эффект Цвет)
  - К эффекту Смена цвета добавлен эффект Пульс (при минимальном Масштабе будет работать эффект Смена цвета)
  - Внесены исправления эффектов Метель и Звездопад от @Rampart
  - У эффекта Матрица изменена цветовая палитра и алгоритм работы (Нестыдная Матрица)
  - Эффект Светлячки со шлейфом заменён на эффект Кометы (в коде оставлены старый эффект, а также дополнительный Кометы мини, но они не подключены)
  - С прошивкой в архиве поставляется 2 приложения. Стандартное может работать только с 26 эффектами. При увеличении количества эффектов будет работать только приложение от @Koteyka
  - В архив с прошивкой добавлен файл с инструкцией в формате книжки. Правда, там уже устарели все ссылки.
  - Добавлен обработчик команды "GBR" для изменения яркости всех эффектов сразу без сохранения в энергонезависимую память. Приложение должно поддерживать данную функцию.
  - Добавлен обработчик команды "LIST" для отправки в приложение количества и реестра установленных эффектов. Приложение должно поддерживать данную функцию.

  Версия 1.4:
  - Исправлен баг при смене режимов
  - Исправлены тормоза в режиме точки доступа
  --- 08.07.2019
  - Исправлены параметры и процесс подключения к WiFi сети (таймаут 7 секунд) и развёртываия WiFi точки доступа (параметры имени/пароля)
  - Добавлено "#define USE_NTP" - позволяет запретить обращаться в интернет
  - Добавлено "#define ESP_USE_BUTTON - позволяет собирать лампу без физической кнопки, иначе яркость эффектов самопроизвольно растёт до максимальной
  - Переработаны параметры IP адресов, STA_STATIC_IP теперь пустой по умолчанию - избавляет от путаницы с IP адресами из неправильных диапазонов
  - Добавлено "#define GENERAL_DEBUG" - выводит в Serial/Telnet некоторые отладочные сообщения
  - Добавлено "#define WIFIMAN_DEBUG (true)" - выводит в Serial/Telnet отладочные сообщения библиотеки WiFiManager
  - Добавлена таблица с тест кейсами
  - Форматирование кода, комментарии
  --- 11.07.2019
  - Исправлена ошибка невыключения матрицы после срабатывания будильника, если до будильника матрица была выключенной
  - Дополнена таблица с тест кейсами
  --- 14.07.2019
  - Исправлена ошибка выключения будильника, если перед его срабатыванием был активен эффект "матрица" (или другой эффект, где задействовано мало светодиодов)
  - Добавлено управление по воздуху:
  -- работает только в режиме WiFi клиента
  -- работает при подключенной кнопке (потому что режим прошивки активируется кнопкой)
  --- 16.07.2019
  - Исправлено регулярное подвисание матрицы на 1-2 секунды при отсутствии подключения к интернету (но при успешном подключении к WiFi)
  --- 28.07.2019
  - Доработано взаимодействие с android приложением (отправка состояния после каждой операции)
  --- 01.08.2019
  - Возврат к стандартной библиотеке GyverButton (изменениё из неё перенесено в button.ino
  - Добавлены 2 эффекта: Светлячки со шлейфом и Белый свет
  - При запросе обновления по воздуху (2 четверных касания к кнопке) лампа переключается в режим "Матрица" для визуального подтверждения готовности к прошивке
  - В android приложение добавлена функция сканирования сети и добавления ламп с помощью multicast пакетов, доработка прошивки под это
  --- 03.08.2019
  - Исправлены ошибки взаимодействия android приложения с лампой, в вывод команды CURR добавлено текущее время (или millis(), если время не синхронизировано)
  --- 10.08.2019
  - Добавлена точная настройка яркости, скорости и масштаба эффектов
  - Добавлено взаимодействие с android приложением по управлению будильниками
  --- 14.08.2019
  - Добавлена функция таймера отключения
  --- 26.08.2019
  - Добавлен режим автоматического переключения избранных эффектов
  - Реорганизован код, исправлены ошибки
  --- 28.08.2019
  - Добавлен вызов режима обновления модуля esp из android приложения
  --- 30.08.2019
  - Эффект "Светлячки со шлейфами" переименован в "Угасающие пиксели"
  - Добавлены 5 новых эффекта: "Радуга диагональная", "Метель", "Звездопад", "Светлячки со шлейфами" (новый) и "Блуждающий кубик"
  - Исправлены ошибки
  --- 04.09.2019
  - Большая часть определений (констант) перенесена в файл Constants.h
  - Большая оптимизация использования памяти
  - Исправлена ошибка невключения эффекта "Белый свет" приложением и кнопкой
  - Исправлена ошибка неправильного выбора интервала в режиме Избранное в android приложении
  --- 16.09.2019
  - Добавлено сохранение состояния (вкл/выкл) лампы в EEPROM память
  - Добавлен новый эффект белого света (с горизонтальной полосой)
  - Реорганизован код, исправлены ошибки
  --- 20.09.2019
  - Добавлена возможность сохранять состояние (вкл/выкл) режима "Избранное"; не сбрасывается выключением матрицы, не сбрасывается перезапуском модуля esp
  - Убрана очистка параметров WiFi при старте с зажатой кнопкой; регулируется директивой ESP_RESET_ON_START, которая определена как false по умолчанию
  --- 24.09.2019
  - Добавлены изменения из прошивка от Alex Gyver v1.5: бегущая строка с IP адресом лампы по пятикратному клику на кнопку
  --- 29.09.2019
  - Добавлена опция вывода отладочных сообщений по пртоколу telnet вместо serial для удалённой отладки
  - Исправлена ошибка регулировки яркости кнопкой
  --- 05.10.2019
  - Добавлено управление по протоколу MQTT
  - Исправлена ошибка выключения будильника кнопкой
  - Добавлена задержка в 1 секунду сразу после старта, в течение которой нужно нажать кнопку, чтобы очистить сохранённые параметры WiFi (если ESP_RESET_ON_START == true)
  --- 12.10.2019
  - Добавлена возможность сменить рабочий режим лампы (ESP_MODE) без необходимости перепрошивки; вызывается по семикратному клику по кнопке при включенной матрице; сохраняется в EEPROM
  - Изменён алгоритм работы будильника:
  -  * обновление его оттенка/яркости происходит 1 раз в 3 секунды вместо 1 раза в минуту
  -  * диоды разбиты на 6 групп, первой из которых назначается новый оттенок/яркость 1 раз в 3 секунды, вторая "отстаёт" на 1 шаг, третья - на 2 шага и т.д. (для большей плавности)
  - Добавлена визуальная сигнализация о некоторых важных действиях/состояниях лампы:
  -  * при запуске в режиме WiFi клиента и ещё не настроенных параметрах WiFi сети (когда их нужно ввести)                                                     - 1 вспышка жёлтым
  -  * если лампа стартовала в режиме WiFi клиента с ненастроенными параметрами WiFi сети, и они не были введены за отведённый таймаут (перед перезагрузкой)   - 1 вспышка красным
  -  * при переходе лампы в режим обновления по воздуху (OTA) по двум четырёхкратным кликам по кнопке или по кнопке OTA из android приложения                  - 2 вспышки жёлтым
  -  * если лампа была переведена в режим OTA, но не дождалась прошивки за отведённый таймаут (перед перезагрузкой)                                            - 2 вспышки красным
  -  * при переключении рабочего режима лампы WiFi точка доступа/WiFi клиент семикратным кликом по кнопке (перед перезагрузкой)                                - 3 вспышки красным
  -  * при запросе вывода времени бегущей строкой, если время не синхронизировано                                                                              - 4 вспышки красным
  - Уменьшен таймаут подключения к WiFi сети до 6 секунд; вызвано увеличившейся продолжительностью работы функции setup(), она в сумме должна быть меньше 8 секунд
  - Оптимизирован код
  --- 14.10.2019
  - Если при первом старте в режиме WiFi клиента запрашиваемые имя и пароль WiFi сети не введены за отведённый таймаут (5 минут), лампа перезагрузится в режиме точки доступа
  - Добавлен вывод времени бегущей строкой:
  -  * по запросу - шестикратному клику - текущее время белым цветом;
  -  * периодически - определяется константой PRINT_TIME в Constants.h - от раза в час (красным цветом) до раза в минуту (синим цветом) с яркостью текущего эффекта как при включенной, так и при выключенной матрице
  --- 19.10.2019
  - Добавлены "ночные часы" (от NIGHT_HOURS_START до NIGHT_HOURS_STOP включительно) и "дневные часы" (всё остальное время), для которых доступна регулировка яркости для вывода времени бегущей строкой - NIGHT_HOURS_BRIGHTNESS и DAY_HOURS_BRIGHTNESS
  --- 20.10.2019
  - Добавлена блокировка кнопки на лампе из android приложения; сохраняется в EEPROM память
  --- 24.10.2019
  - Добавлен вывод сигнала (HIGH/LOW - настраивается константой MOSFET_LEVEL) синхронно с включением матрицы на пин MOSFET транзистора (настраивается константой MOSFET_PIN)
  - Добавлен вывод сигнала (HIGH/LOW - настраивается константой ALARM_LEVEL) на пин будильника (настраивается константой ALARM_PIN); сигнал подаётся в течение одной минуты, начиная со времени, на которое заведён будильник
  --- 02.11.2019
  - Добавлен переход на летнее/зимнее время (изменены настройки часового пояса, см. Constants.h); добавлена библиотека Timezone
  - Добавлен эффект Белый огонь
  - Исправлена ошибка сброса сигнала на пине ALARM_PIN при отключении будильника вручную
  - Добавлена сигнализация (4 вспышки красным) при запросе вывода времени шестикратным кликом, если время не синхронизировано
  --- 04.11.2019
  - Исправлена ошибка невключения MOSFET'а матрицы при срабатывании "рассвета"
  - Исправлена ошибка невключения MOSFET'а матрицы при выводе времени и IP адреса
  --- 08.11.2019
  - Исправлены ошибки назначения статического IP адреса
  - Добавлен набросок WiFiManager Captive Portal для ввода пользовательских параметров и настроек
